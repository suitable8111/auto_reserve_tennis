감사합니다. 이번에 올려주신 추가 대화 내용을 통해 매크로 프로그램 개발 요구사항이 훨씬 명확해졌습니다. 전체 내용을 바탕으로 기획 및 개발 사양서 수준의 정리를 아래와 같이 제공드립니다.

⸻

✅ 테니스장 예약 자동화 매크로 프로그램 개발 기획안 (정리본)

1. 🎯 프로젝트 목적
	•	진주 남가람 테니스장 예약 시스템(wjpsc.or.kr)에서 원하는 날짜·시간·코트에 자동으로 예약을 시도
	•	경쟁이 치열한 예약 상황에서도 성공률을 높이기 위해 예약 대상 분할 및 자동화 시도 로직 구현

⸻

2. ⚙️ 기능 요건 정리

📌 A. 입력 조건

항목	상세
날짜	최대 3일 지정 가능
시간	19, 20, 21 중 선택 또는 고정 (19~21 고정으로 입력됨)
코트	야외 3, 4, 7번(기본), 정구 1, 2번(옵션 추가 요청)
사용자 정보	이름, 전화번호, 계좌번호, 은행명, 동호회명

✅ 한 세트 기준: 1일 + 1시간 → 최대 3세트 (예: 2025-04-21 19시, 2025-04-22 20시, 2025-04-24 21시)

⸻

📌 B. 자동화 시나리오
	1.	예약 페이지 접속 및 대기 (크론 or 지정 시간 실행)
	2.	날짜/시간/코트 조합 순서대로 예약 시도
	3.	예약 실패 시 → 다음 코트 → 다음 시간 → 다음 날짜 순서로 시도
	4.	예약 성공 or 실패 메시지 감지 후 다음 세트 진행
	5.	실패시 로그 남기고 다음 작업으로 진행

⸻

📌 C. 예외 처리

상황	처리 방식
예약 페이지 열림 지연	15일 09:00 오픈 기준 대기 후 실행
시간 미입력 팝업 발생	Alert 처리 로직 추가 (예: “시간을 선택해 주세요” 경고창 감지)
예약 중복 또는 실패	자동으로 다음 코트/시간/날짜로 넘어가도록 구성
오류 메시지 발생 시	로그 저장 및 다음 순번으로 넘어가기


⸻

3. 🧩 사용자 지정 확장성
	•	사용자명/전화번호 조합별로 예약 → 3~4명에게 배분하여 동시 프로그램 실행 가능
	•	코트별로 그룹화 및 병렬 실행도 가능하도록 프로그램 내부 구조 설계

⸻

4. 🧪 테스트 결과 및 반영
	•	✅ 날짜 3개 + 시간 3개 → 잘 동작
	•	❌ 날짜 2개 + 시간 2개 → 중간 멈춤 현상 → 예외 처리 로직 개선 필요
	•	✅ 동일 날짜, 서로 다른 코트 예약 허용 (동일 계정 기준)

⸻

5. 💻 오류 및 수정 내역 (예시 기반)

오류	원인 및 조치
UnexpectedAlert: 시간을 선택해 주세요	예약 페이지 Alert 미처리 → Alert 수동 확인 후 예외 처리 로직 추가
Stacktrace 관련 오류	Selenium의 find_element 실패 → 페이지 로딩 지연 및 타이밍 이슈 보완 필요
야외 4번 코트에서 멈춤	특정 코트에서 예약창 진입 실패 시 멈춤 → 조건 분기 및 예외 처리 필요


⸻

6. 🧾 추가 요청 내용
	•	정구 1,2 코트 버전 별도 요청 → 기존 프로그램과 동일 기능 구성
	•	비용 제안: 5만 원
	•	기존 프로그램에 통합하지 않고 분리 요청됨 (총 2개로 운영)

⸻

7. ✅ 개발자에게 전달할 주요 구현 포인트
	•	크론 기반 자동 실행
	•	DOM 구조 안정성 확보 (예약 버튼, 시간 선택 등 위치 고정)
	•	Alert / 예약 실패 메시지 감지 후 재시도 루틴
	•	한 세트 = 날짜+시간 매핑 → 최대 3세트까지 가능
	•	로그 저장 및 사용자에게 피드백 전달 가능 구조 고려

⸻

8. 🔐 주의 사항
	•	과도한 매크로 사용 시 관리자 제재 가능성 있음 (동일 계정 과도 예약)
	•	동일 날짜에 서로 다른 코트는 예약 가능하나, 여러 명 분산 운영 필요

⸻

다음 단계
	•	혹시 5월 예약 오픈 전에 프로그램 테스트를 원하시거나,
	•	GUI 기반 매크로 설정기(날짜/시간/사용자 정보 입력 도구)가 필요하신지 확인 부탁드립니다.

원하시면 위 내용을 토대로 .exe, .py, .bat 실행 환경 안내도 함께 정리해드릴 수 있습니다.

어떻게 도와드릴까요?